======================================================================================================================
DESCRIPTION:

tmf.core/ui: Move some logic of the symbol provider to core

This moves the Symbol provider to core. Special care must be taken to
ensure that the preference page is available if required.

Moves callstack symbol providers to core interfaces.

Most changes are internal, so this does not affect the API much.
Also, now CallgraphAnalysis can be in Core.

Change-Id: Ie4c37b670f599fad8fb74e08b458c0db65bb312c
Signed-off-by: Matthew Khouzam <matthew.khouzam@ericsson.com>

======================================================================================================================
COMMENTS
======================================================================================================================
Author: Matthew Khouzam
Date: 2017-04-17 05:24:14.000000000
Message: 
Uploaded patch set 3.
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2017-04-17 05:24:20.000000000
Message: 
Patch Set 3:

Build Started https://hudson.eclipse.org/tracecompass/job/tracecompass-gerrit/13197/
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2017-04-17 06:14:14.000000000
Message: 
Patch Set 3: Code-Review+1

Build Successful 

https://hudson.eclipse.org/tracecompass/job/tracecompass-gerrit/13197/ : SUCCESS
----------------------------------------------------------------------------------------------------------------------
Author: Patrick Tasse
Date: 2017-04-17 17:51:16.000000000
Message: 
Patch Set 3: Code-Review-1

(12 comments)
Line:15, analysis/org.eclipse.tracecompass.analysis.timing.core/plugin.xml -> Could/should it apply to ITmfTrace instead?

Line:76, analysis/org.eclipse.tracecompass.analysis.timing.core/src/org/eclipse/tracecompass/internal/analysis/timing/core/callgraph/SymbolAspect.java -> Maybe just call the other method if you have a pid? See other comments.

Line:134, analysis/org.eclipse.tracecompass.analysis.timing.ui/src/org/eclipse/tracecompass/internal/analysis/timing/ui/flamegraph/FlameGraphPresentationProvider.java -> Maybe just call the other method if you have a pid? See other comments.

Line:8, tmf/org.eclipse.tracecompass.tmf.core/plugin.xml -> Needs to be externalized?

Line:26, tmf/org.eclipse.tracecompass.tmf.core/schema/org.eclipse.tracecompass.tmf.core.symbolProvider.exsd -> trailing spaces

Line:93, tmf/org.eclipse.tracecompass.tmf.core/schema/org.eclipse.tracecompass.tmf.core.symbolProvider.exsd -> Please provider documention for this and the following sections.

Line:24, tmf/org.eclipse.tracecompass.tmf.core/src/org/eclipse/tracecompass/tmf/core/symbols/DefaultSymbolProvider.java -> What should happen to the DefaultSymbolProvider implementation in UI package? Should it be deprecated?

Line:39, tmf/org.eclipse.tracecompass.tmf.core/src/org/eclipse/tracecompass/tmf/core/symbols/DefaultSymbolProvider.java -> This can remain non-null by default?

Line:64, tmf/org.eclipse.tracecompass.tmf.core/src/org/eclipse/tracecompass/tmf/core/symbols/DefaultSymbolProvider.java -> Maybe just let it return default implementation, see other comments.

Line:18, tmf/org.eclipse.tracecompass.tmf.core/src/org/eclipse/tracecompass/tmf/core/symbols/ISymbolProviderFactory.java -> core

Line:1986, tmf/org.eclipse.tracecompass.tmf.ui/plugin.xml -> use a better id? Maybe symbolProviderFactory.basic?

Line:1989, tmf/org.eclipse.tracecompass.tmf.ui/plugin.xml -> Maybe does not need to be moved down?

----------------------------------------------------------------------------------------------------------------------
Author: Matthew Khouzam
Date: 2017-04-17 17:56:59.000000000
Message: 
Patch Set 3:

(3 comments)

Thanks, is the approach ok?
Line:15, analysis/org.eclipse.tracecompass.analysis.timing.core/plugin.xml -> Sure

Line:8, tmf/org.eclipse.tracecompass.tmf.core/plugin.xml -> yes

Line:26, tmf/org.eclipse.tracecompass.tmf.core/schema/org.eclipse.tracecompass.tmf.core.symbolProvider.exsd -> Autogenerated

----------------------------------------------------------------------------------------------------------------------
Author: Patrick Tasse
Date: 2017-04-17 18:26:06.000000000
Message: 
Patch Set 3:

(1 comment)

> Thanks, is the approach ok?

Reading back my old comments on the patch from last year, one concern I had was that if there is an implementation somewhere that uses the now-deprecated UI extension point, it won't work anymore because the framework never calls the deprecated UI SymbolProviderManager.

How to avoid breaking functionality? I'm thinking that the UI SymbolProviderManager could, at startup, gather all its factories and programmatically add them to the core SymbolProviderManager?

Note that this would require that UI ISymbolProviderFactory extend core ISymbolProviderFactory. And it should be deprecated?
Line:65, tmf/org.eclipse.tracecompass.tmf.core/schema/org.eclipse.tracecompass.tmf.core.symbolProvider.exsd -> This is rather weak documentation ;)

----------------------------------------------------------------------------------------------------------------------
Author: Matthew Khouzam
Date: 2017-04-20 13:58:40.000000000
Message: 
Patch Set 3:

(5 comments)
Line:15, analysis/org.eclipse.tracecompass.analysis.timing.core/plugin.xml -> Actually No. ITmfTrace is an interface, not a class

Line:76, analysis/org.eclipse.tracecompass.analysis.timing.core/src/org/eclipse/tracecompass/internal/analysis/timing/core/callgraph/SymbolAspect.java -> See below, it is a fallback, should I run it after?

Line:134, analysis/org.eclipse.tracecompass.analysis.timing.ui/src/org/eclipse/tracecompass/internal/analysis/timing/ui/flamegraph/FlameGraphPresentationProvider.java -> How about using the aspect?

Line:39, tmf/org.eclipse.tracecompass.tmf.core/src/org/eclipse/tracecompass/tmf/core/symbols/DefaultSymbolProvider.java -> It would break the API, let's wait for the next patch in the chain.

Line:18, tmf/org.eclipse.tracecompass.tmf.core/src/org/eclipse/tracecompass/tmf/core/symbols/ISymbolProviderFactory.java -> Done

----------------------------------------------------------------------------------------------------------------------
Author: Gerrit Code Review
Date: 2017-04-24 01:50:02.000000000
Message: 
Change has been successfully cherry-picked as 37c8703272c0bba0c0d344fb9572c0d600244ec1 by Matthew Khouzam
----------------------------------------------------------------------------------------------------------------------
