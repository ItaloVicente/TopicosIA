======================================================================================================================
DESCRIPTION:

re-factor compile_roles so filtering part of it can be reused

Change-Id: Ic26b1c42ee8220286f94fae44555e59ab4064928
Reviewed-on: http://review.couchbase.org/77586
Reviewed-by: Aliaksey Artamonau <aliaksiej.artamonau@gmail.com>
Tested-by: Aliaksey Artamonau <aliaksiej.artamonau@gmail.com>

======================================================================================================================
COMMENTS
======================================================================================================================
Author: Aliaksey Artamonau
Date: 2017-05-02 18:46:37.000000000
Message: 
Change has been successfully cherry-picked as c9cc8271fe1e05a6af471c73300d54a5caba0fad by Aliaksey Artamonau
----------------------------------------------------------------------------------------------------------------------
