======================================================================================================================
DESCRIPTION:

Security_filter and filter_by_roles functions refactoring

Change-Id: Ic0b935fbb9eed9de2f4f9a0abf3c69797ab7948e
Reviewed-on: http://review.couchbase.org/102399
Well-Formed: Build Bot <build@couchbase.com>
Tested-by: Timofey Barmin <timofey.barmin@couchbase.com>
Reviewed-by: Artem Stemkovski <artem@couchbase.com>

======================================================================================================================
COMMENTS
======================================================================================================================
Author: Artem Stemkovski
Date: 2019-01-10 23:11:45.000000000
Message: 
Change has been successfully cherry-picked as 912a3ea74f07626a78219f3f4fff1ba1ecc71ef6 by Artem Stemkovski
----------------------------------------------------------------------------------------------------------------------
