======================================================================================================================
DESCRIPTION:

MB-53493: Ignore use_vbmap_greedy_optimization opt ...

... when comparing vbmaps.

1. vbmaps stored in vbmap_history include the opts used to generate a given
  vbmap. In 7.1.1 we introduced an option 'use_vbmap_greedy_optimization'
  which was to be used to disable the greedy vbmap algorithm.

2. When we do a delta recovery of a node upgraded to 7.1.1 and try to
   compare the existing vbmaps opts, none of them match vbmap opts for
   vbmap generated by pre-7.1.1 versions.

This fixes the above issue by ignoring the
'use_vbmap_greedy_optimization' option.

Change-Id: I6a4f92ae9f786f68190e6012567f6213dc13861b

======================================================================================================================
COMMENTS
======================================================================================================================
Author: Hareen Kancharla
Date: 2022-09-19 16:23:24.000000000
Message: 
Uploaded patch set 3.
----------------------------------------------------------------------------------------------------------------------
Author: Build Bot
Date: 2022-09-19 16:23:32.000000000
Message: 
Patch Set 3:

Build Started https://cv.jenkins.couchbase.com/job/ns-server-test/31546/
----------------------------------------------------------------------------------------------------------------------
Author: Build Bot
Date: 2022-09-19 16:28:59.000000000
Message: 
Patch Set 3: Well-Formed+1

Build Successful 

https://cv.jenkins.couchbase.com/job/ns-server-test/31546/ : SUCCESS
----------------------------------------------------------------------------------------------------------------------
Author: Hareen Kancharla
Date: 2022-09-19 17:11:21.000000000
Message: 
Patch Set 3:

(1 comment)
File Comment: /PATCHSET_LEVEL -> make simple-test
----------------------------------------------------------------------------------------------------------------------
Author: Build Bot
Date: 2022-09-19 17:11:27.000000000
Message: 
Patch Set 3:

Build Started https://cv.jenkins.couchbase.com/job/ns-server-simple-test/3891/
----------------------------------------------------------------------------------------------------------------------
Author: Abhijeeth Nuthan
Date: 2022-09-19 17:47:24.000000000
Message: 
Patch Set 3:

(1 comment)
Line:310, src/mb_map.erl -> looks fine to me. Need a comment explaining why tags and use_vbmap_greedy_optimization are omitted from the check here.

----------------------------------------------------------------------------------------------------------------------
Author: Build Bot
Date: 2022-09-19 18:03:24.000000000
Message: 
Patch Set 3: Verified-1

Build Failed 

https://cv.jenkins.couchbase.com/job/ns-server-simple-test/3891/ : FAILURE

ERROR: suite_setUp (unittest.loader._FailedTest)
 ( https://cv.jenkins.couchbase.com/job/ns-server-simple-test/3891/ )
----------------------------------------------------------------------------------------------------------------------
Author: Hareen Kancharla
Date: 2022-09-19 18:13:11.000000000
Message: 
Patch Set 3:

(1 comment)
Line:310, src/mb_map.erl -> Right, probably worth discussing this point in the context of the "upcoming" code-review guidelines. For smaller patches, where do you prefer to have the comment - in the commit message or here in the code? I avoided adding the comment because it would have been a duplicate of what's already in the commit message.

----------------------------------------------------------------------------------------------------------------------
Author: Abhijeeth Nuthan
Date: 2022-09-19 18:21:47.000000000
Message: 
Patch Set 3:

(1 comment)
Line:310, src/mb_map.erl -> Good point. Thanks. I prefer doing both(I'm flexible on this though), especially in this case since you are overwriting the git history for why the tag was omitted :)

----------------------------------------------------------------------------------------------------------------------
Author: Hareen Kancharla
Date: 2022-09-19 19:24:17.000000000
Message: 
Patch Set 3:

(1 comment)
Line:310, src/mb_map.erl -> I would prefer we suggest having it only as a comment then (for this particular case); putting the same message at two places sounds excessive. Will move the message from the commit message here.

----------------------------------------------------------------------------------------------------------------------
