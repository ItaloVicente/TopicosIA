======================================================================================================================
DESCRIPTION:

Bug 575702: Nondeterministic makefile ordering

Several parts of makefile output were generated by iterating over
HashMaps, which do not have a deterministic iteration order. Use
TreeMaps instead to output in sorted order. This is possible now that
the API function with return type HashMap is no longer public API and
can be changed to return Map instead.

Benchmark files for affected tests are updated to the new ordering.
This would not be strictly necessary: the tests would also succeed
without, since org.eclipse.cdt.managedbuilder.testplugin.
ManagedBuildTestHelper.compareMakefiles() uses a reordering-tolerant
comparison. However, recording the new (now hopefully stable) order
makes future development on makefile generation easier by avoiding
spurious diff output when tests fail due to changes to other parts of
makefiles.

Change-Id: I20f2e51bd5b9e3bcc5da245d781ca5b4a34fc0b2
Signed-off-by: Christian Walther <walther@indel.ch>

======================================================================================================================
COMMENTS
======================================================================================================================
Author: Christian Walther
Date: 2021-11-02 13:08:09.000000000
Message: 
Uploaded patch set 2.
----------------------------------------------------------------------------------------------------------------------
Author: Christian Walther
Date: 2021-11-02 13:20:07.000000000
Message: 
Patch Set 2:

I went from LinkedHashMap to TreeMap in patch set 2 as originally discussed in https://git.eclipse.org/r/c/cdt/org.eclipse.cdt/+/184215 because the function that stood in the way of that is not public API anymore after the move to gnu2.
----------------------------------------------------------------------------------------------------------------------
Author: CDT Bot
Date: 2021-11-02 13:30:43.000000000
Message: 
Patch Set 2: Verified-1

Build Unstable 

https://ci.eclipse.org/cdt/job/cdt-verify-test-cdt-other-pipeline/3850/ : UNSTABLE. p2 repository available on https://ci.eclipse.org/cdt/job/cdt-verify-test-cdt-other-pipeline/3850/artifact/releng/org.eclipse.cdt.repo/target/repository/ - please mark build as "Keep this build forever" if the p2 repo is needed for testing. Otherwise it will be deleted shortly.

https://ci.eclipse.org/cdt/job/cdt-verify-test-cdt-ui-only-pipeline/3626/ : SUCCESS

https://ci.eclipse.org/cdt/job/cdt-verify-code-cleanliness-pipeline/3422/ : SUCCESS. Formatting, whitespace, version numbers and other checks appear to be correct. See https://github.com/eclipse-cdt/cdt-infra/tree/master/jenkins/pipelines/cdt/verify#cdt-verify-code-cleanliness for documentation on what is checked.
----------------------------------------------------------------------------------------------------------------------
Author: Christian Walther
Date: 2021-11-02 13:39:47.000000000
Message: 
Patch Set 2:

The test failed here is flaky in my experience and occasionally failed in my local testing too (before and after my change), in various places around the whole BuildDescriptionModelTests class, more often when running all of org.eclipse.cdt.managedbuilder.core.tests than just this class. I haven’t spent any effort on figuring out why.
----------------------------------------------------------------------------------------------------------------------
Author: CDT Bot
Date: 2021-11-02 13:59:26.000000000
Message: 
Patch Set 2: Verified+1

Build Successful 

https://ci.eclipse.org/cdt/job/cdt-verify-test-cdt-ui-only-pipeline/3626/ : SUCCESS

https://ci.eclipse.org/cdt/job/cdt-verify-code-cleanliness-pipeline/3422/ : SUCCESS. Formatting, whitespace, version numbers and other checks appear to be correct. See https://github.com/eclipse-cdt/cdt-infra/tree/master/jenkins/pipelines/cdt/verify#cdt-verify-code-cleanliness for documentation on what is checked.

https://ci.eclipse.org/cdt/job/cdt-verify-test-cdt-other-pipeline/3852/ : SUCCESS. p2 repository available on https://ci.eclipse.org/cdt/job/cdt-verify-test-cdt-other-pipeline/3852/artifact/releng/org.eclipse.cdt.repo/target/repository/ - please mark build as "Keep this build forever" if the p2 repo is needed for testing. Otherwise it will be deleted shortly.
----------------------------------------------------------------------------------------------------------------------
Author: Torbjörn Svensson
Date: 2021-11-02 13:59:34.000000000
Message: 
Patch Set 2:

I relaunched the gerrit job that fail just for the sake of a good verdict here.
Once the result is in, I will +2 and merge as soon as you +1 @Christian.
----------------------------------------------------------------------------------------------------------------------
Author: Christian Walther
Date: 2021-11-02 14:07:09.000000000
Message: 
Patch Set 2: Code-Review+1

Thanks for the quick review!
----------------------------------------------------------------------------------------------------------------------
Author: Torbjörn Svensson
Date: 2021-11-02 14:21:07.000000000
Message: 
Patch Set 2: Code-Review+2
----------------------------------------------------------------------------------------------------------------------
Author: Torbjörn Svensson
Date: 2021-11-02 14:22:19.000000000
Message: 
Change has been successfully merged by Torbjörn Svensson
----------------------------------------------------------------------------------------------------------------------
