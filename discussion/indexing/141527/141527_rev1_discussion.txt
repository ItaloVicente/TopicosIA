======================================================================================================================
DESCRIPTION:

MB-36746 Address Varun's review comments

(This is now the third change set of the complete patchi implementation #3.)

Change-Id: Ia720aace9686e8b6d9aed0fa475ba0e7db5dd6ac

======================================================================================================================
COMMENTS
======================================================================================================================
Author: Kevin Cherkauer
Date: 2020-12-05 02:04:09.000000000
Message: 
Uploaded patch set 1.
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-05 07:48:52.000000000
Message: 
Patch Set 1: Code-Review+1

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-05.12.2020-09.54.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-05 11:29:31.000000000
Message: 
Patch Set 1: -Code-Review

MAYBE FAIL sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-05.12.2020-13.30.fail.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-05 15:42:55.000000000
Message: 
Patch Set 1:

MAYBE FAIL sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-05.12.2020-17.11.fail.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-05 19:19:35.000000000
Message: 
Patch Set 1: Code-Review+1

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-05.12.2020-21.24.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-05 23:01:43.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-06.12.2020-01.01.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-06 04:04:47.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-06.12.2020-05.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-06 07:39:53.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-06.12.2020-09.46.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-06 11:19:09.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-06.12.2020-13.21.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-06 15:34:27.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-06.12.2020-17.00.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-06 19:10:40.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-06.12.2020-21.15.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-06 22:50:57.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-07.12.2020-00.52.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-07 04:12:09.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-07.12.2020-05.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-07 07:49:42.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-07.12.2020-09.53.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-07 11:38:56.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-07.12.2020-13.31.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-07 15:55:12.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-07.12.2020-17.20.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-07 17:14:44.000000000
Message: 
Removed reviewer CI Bot with the following votes:

* Code-Review+1 by CI Bot (1004336)

----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-07 19:16:29.000000000
Message: 
Removed reviewer Deepkaran Salooja.
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-07 19:16:32.000000000
Message: 
Removed reviewer John Liang.
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-08 20:20:45.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-08.12.2020-22.26.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-08 23:49:41.000000000
Message: 
Patch Set 1: -Code-Review

MAYBE FAIL sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-09.12.2020-02.02.fail.html
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-09 02:56:14.000000000
Message: 
Removed reviewer CI Bot.
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-14 23:21:29.000000000
Message: 
Removed reviewer null.
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-15 03:31:44.000000000
Message: 
Patch Set 1: Code-Review+1

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-15.12.2020-05.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-15 07:50:25.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-15.12.2020-09.13.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-15 11:28:09.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-15.12.2020-13.32.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-15 15:56:48.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-15.12.2020-18.03.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-15 19:37:54.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-15.12.2020-21.38.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-15 23:54:58.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-16.12.2020-01.19.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-16 03:26:18.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-16.12.2020-05.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: Deepkaran Salooja
Date: 2020-12-16 06:33:57.000000000
Message: 
Patch Set 1:

(6 comments)
Line:266, secondary/indexer/flusher.go -> It would be better to have it as GetKeyspaceStats(streamId, keyspaceId) and internally check if the map is not nil before accessing.

Line:310, secondary/indexer/flusher.go -> It would be better to have it as GetKeyspaceStats(streamId, keyspaceId) and internally check if the map is not nil before accessing.

Line:356, secondary/indexer/flusher.go -> It would be better to have it as GetKeyspaceStats(streamId, keyspaceId) and internally check if the map is not nil before accessing.

Line:281, secondary/indexer/stats_manager.go -> This function can return KeyspaceStatsMap instead of a pointer.

Line:2040, secondary/indexer/stats_manager.go -> This can return KeyspaceStatsMap instead of *KeyspaceStatsMap.

Line:2041, secondary/indexer/stats_manager.go -> check if ksm == nil for safety.

----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-16 07:09:03.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-16.12.2020-09.07.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-16 11:25:22.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-16.12.2020-12.50.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-16 15:03:45.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-16.12.2020-17.06.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-16 18:43:38.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-16.12.2020-20.45.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2020-12-16 23:00:01.000000000
Message: 
Patch Set 1:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-17.12.2020-00.25.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-16 21:44:28.000000000
MISMATCHED INLINE COMMENT
Line:266, secondary/indexer/flusher.go -> Done, except it is not possible to push the nil pointer check inside the new method. Updated similar calls in storage_manager.go, stream_reader.go, timekeeper.go as well.
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-16 21:44:28.000000000
MISMATCHED INLINE COMMENT
Line:310, secondary/indexer/flusher.go -> Done, except it is not possible to push the nil pointer check inside the new method. Updated similar calls in storage_manager.go, stream_reader.go, timekeeper.go as well.
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-16 21:44:28.000000000
MISMATCHED INLINE COMMENT
Line:356, secondary/indexer/flusher.go -> Done, except it is not possible to push the nil pointer check inside the new method. Updated similar calls in storage_manager.go, stream_reader.go, timekeeper.go as well.
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-16 21:44:28.000000000
MISMATCHED INLINE COMMENT
Line:281, secondary/indexer/stats_manager.go -> Done. This change cascaded to a few other places.
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-16 21:44:28.000000000
MISMATCHED INLINE COMMENT
Line:2040, secondary/indexer/stats_manager.go -> Done
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2020-12-16 21:44:28.000000000
MISMATCHED INLINE COMMENT
Line:2041, secondary/indexer/stats_manager.go -> It is not possible for ksm to be nil as it is the receiver of this method. If it were nil the caller would have gotten a nil pointer dereference error trying to call ksm.Clone() so this method could never have been entered.
----------------------------------------------------------------------------------------------------------------------
