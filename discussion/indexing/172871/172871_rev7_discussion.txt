======================================================================================================================
DESCRIPTION:

MB-51425 Keep minNumShard consistent with max_cpu_percent unless changed explicitly

The config "plasma.minNumShard" is both a primary config and derived
config. Primary means that user can change it directly through
indexer settings endpoint. However, this stat also gets changed if
max_cpu_percent changes making it a derived config. However, the change
due to max_cpu_percent is not persisted in metakv.

So, if max_cpu_percent changes and some other setting change happens,
indexer will have the last persisted config.

E.g., on a 80 core box, default value of minNumShard will be 20. This
value will be persisted in metakv. If the max_cpu_percent changes to
2000, then minNumShard value will be changed to 5. However, if any other
setting change happens, then settings manager will construct the
minNumShard value from metakv and sends its value as 20. As there is no
change in max_cpu_percent indexer will continue to use 20. This results
in minNumShard value deviating from
math.Max(2, (max_cpu_percent/100) * 0.25).

This can lead to more shards than expected and therefore take performance
hit.

This patch fixes the issue by keeping minNumShard value in sync with
max_cpu_percent unless user changes explicitly.

Change-Id: I2d824c156a46239da2682cdef16db8a923f00ca5

======================================================================================================================
COMMENTS
======================================================================================================================
Author: VarunVelamuri
Date: 2022-03-26 18:30:14.000000000
Message: 
Patch Set 7: Commit message was updated.
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-27 02:30:39.000000000
Message: 
Patch Set 7: Code-Review+1

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-27.03.2022-04.02.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-27 07:57:29.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-27.03.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-27 13:04:39.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-27.03.2022-13.38.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-27 17:15:01.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-27.03.2022-18.46.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-27 21:24:02.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-27.03.2022-22.56.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-28 02:31:22.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-28.03.2022-03.05.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-28 07:59:20.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-28.03.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-28 12:08:13.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-28.03.2022-13.40.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-28 17:15:01.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-28.03.2022-17.49.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-28 21:25:23.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-28.03.2022-22.56.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: Kevin Cherkauer
Date: 2022-03-28 21:29:14.000000000
Message: 
Patch Set 7:

(1 comment)
Line:1553, secondary/indexer/indexer.go -> I think this should be runtime.GOMAXPROCS(0), not runtime.NumCPU(). If plasma.minNumShard was originally initialized based on runtime.NumCPU() that is another bug. runtime.GOMAXPROCS(0) is supposed to have been set to min(hardware, cgroup, GSI) at startup before anything else used it or made calculations from it, and then we should never be using runtime.NumCPU() anymore, only runtime.GOMAXPROCS(0).

----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-29 01:32:48.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-29.03.2022-03.06.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: VarunVelamuri
Date: 2022-03-29 04:06:49.000000000
Message: 
Patch Set 7:

(1 comment)
Line:1553, secondary/indexer/indexer.go -> At this point in code, currCpu can not be computed based on runtime.GOMAXPROCS(0) as any settings change would have already updated the GOMAXPROCS. The goal here is to get the old value of the number of CPU's and update the "plasma.minNumShard" setting only if user has not changed it explicitly. If user has chosen to make this setting change, then this patch honours it irrespective of max_cpu_percent.

That said, I totally missed the CGROUP info. Thanks for pointing this out. 

One way to keep take this forward is to honour both max_cpu_percent or plasma.minNumShard settings change i.e. any setting change would update minNumShard value. This was the behaviour before. I will think more about this and update the patch.

----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-29 08:56:57.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-29.03.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-29 13:08:24.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-29.03.2022-14.38.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-29 18:07:01.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-29.03.2022-18.49.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: John Liang
Date: 2022-03-29 18:14:54.000000000
Message: 
Patch Set 7:

(1 comment)
Line:1561, secondary/indexer/indexer.go -> We change minNumShard if it has not changed?

----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-30 00:28:00.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-29.03.2022-23.48.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-30 08:03:42.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-30.03.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-30 12:17:16.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-30.03.2022-13.45.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-30 17:26:02.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-30.03.2022-17.58.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-30 21:37:02.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-30.03.2022-23.07.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-31 01:45:31.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-31.03.2022-03.18.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-31 08:56:27.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-31.03.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-31 13:05:52.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-31.03.2022-14.37.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-31 17:13:03.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-31.03.2022-18.47.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-03-31 22:21:08.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-31.03.2022-22.54.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-01 02:30:53.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-01.04.2022-04.02.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-01 07:57:19.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-01.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: VarunVelamuri
Date: 2022-04-01 12:25:33.000000000
Message: 
Removed Code-Review+1 by <GERRIT_ACCOUNT_1004336>

----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-01 13:04:23.000000000
Message: 
Patch Set 7: Code-Review+1

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-01.04.2022-13.38.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-01 17:47:37.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-01.04.2022-19.17.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-01 21:57:54.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-01.04.2022-23.29.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-02 03:04:29.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-02.04.2022-03.39.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-02 07:58:27.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-02.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-02 12:06:23.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-02.04.2022-13.39.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-02 17:14:36.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-02.04.2022-17.47.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-02 21:25:23.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-02.04.2022-22.56.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-03 01:34:26.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-03.04.2022-03.06.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-03 08:56:25.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-03.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-03 13:07:12.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-03.04.2022-14.37.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-03 17:15:19.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-03.04.2022-18.48.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-03 22:23:54.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-03.04.2022-22.56.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-04 02:33:24.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-04.04.2022-04.05.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-04 07:57:25.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-04.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-04 13:05:58.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-04.04.2022-13.38.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-04 17:16:23.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-04.04.2022-18.47.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-04 21:33:10.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-04.04.2022-22.57.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-05 02:41:18.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-05.04.2022-03.14.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-05 07:59:41.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-05.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-05 12:06:40.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-05.04.2022-13.41.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-05 17:16:32.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-05.04.2022-17.48.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-05 21:27:20.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-05.04.2022-22.58.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-06 01:35:48.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-06.04.2022-03.08.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-06 08:55:54.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-06.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-06 13:05:24.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-06.04.2022-14.37.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-06 17:13:37.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-06.04.2022-18.47.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-06 22:24:08.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-06.04.2022-22.55.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: VarunVelamuri
Date: 2022-04-07 01:00:47.000000000
Message: 
Removed Code-Review+1 by <GERRIT_ACCOUNT_1004336>

----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-07 02:34:11.000000000
Message: 
Patch Set 7: Code-Review+1

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-07.04.2022-04.05.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-07 07:57:05.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-07.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-07 13:04:05.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-07.04.2022-13.38.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-07 17:14:29.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-07.04.2022-18.45.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-07 21:23:27.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-07.04.2022-22.56.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-08 02:32:00.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-08.04.2022-03.04.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-08 07:59:11.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-08.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-08 12:06:19.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-08.04.2022-13.40.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-08 17:14:42.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-08.04.2022-17.47.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-08 19:02:27.000000000
Message: 
Patch Set 7: -Code-Review

MAYBE FAIL sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-08.04.2022-22.56.fail.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-08 23:09:45.000000000
Message: 
Patch Set 7: Code-Review+1

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-09.04.2022-00.43.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-09 08:54:38.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-09.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-09 13:04:23.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-09.04.2022-14.36.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-09 17:11:44.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-09.04.2022-18.45.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-09 22:18:05.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-09.04.2022-22.53.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-10 02:29:28.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-10.04.2022-03.59.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-10 07:58:21.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-10.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-10 13:06:11.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-10.04.2022-13.39.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-10 17:18:33.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-10.04.2022-18.47.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-10 21:27:35.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-10.04.2022-23.00.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-11 02:35:37.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-11.04.2022-03.09.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-11 08:00:35.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-11.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-11 12:07:45.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-11.04.2022-13.42.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-11 17:14:28.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-11.04.2022-17.49.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-11 21:24:11.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-11.04.2022-22.55.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-12 01:34:18.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-12.04.2022-03.05.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-12 08:57:52.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-12.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-12 15:03:58.000000000
Message: 
Patch Set 7: -Code-Review

MAYBE FAIL sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-12.04.2022-14.39.fail.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-12 19:12:44.000000000
Message: 
Patch Set 7: Code-Review+1

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-12.04.2022-20.45.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-13 00:20:28.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-13.04.2022-00.54.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-13 08:01:08.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-13.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-13 12:09:46.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-13.04.2022-13.42.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-13 17:18:06.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-13.04.2022-17.51.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-13 21:29:59.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-13.04.2022-22.59.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-14 01:38:07.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-14.04.2022-03.11.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-14 08:57:39.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-14.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-14 13:09:05.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-14.04.2022-14.39.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-14 17:18:51.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-14.04.2022-18.50.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-14 22:31:19.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-14.04.2022-23.00.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-15 02:42:12.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-15.04.2022-04.13.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-15 07:58:12.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-15.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-15 13:19:14.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-15.04.2022-13.39.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-15 17:31:12.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-15.04.2022-19.01.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-15 21:41:24.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-15.04.2022-23.12.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-16 02:54:39.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-16.04.2022-03.23.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-16 07:59:41.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-16.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-16 12:08:00.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-16.04.2022-13.41.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-16 17:18:29.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-16.04.2022-17.49.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-16 21:30:48.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-16.04.2022-23.00.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-17 01:40:37.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-17.04.2022-03.12.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-17 08:58:09.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-17.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-17 13:09:35.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-17.04.2022-14.39.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-17 17:18:56.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-17.04.2022-18.51.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-17 22:26:31.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-17.04.2022-23.00.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-18 02:36:35.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-18.04.2022-04.08.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-18 07:59:05.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-18.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-18 13:08:12.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-18.04.2022-13.40.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-18 17:21:42.000000000
Message: 
Patch Set 7: -Code-Review

MAYBE FAIL sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-18.04.2022-18.50.fail.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-18 22:38:42.000000000
Message: 
Patch Set 7: Code-Review+1

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-19.04.2022-00.11.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-19 03:49:04.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-19.04.2022-04.20.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-19 08:00:06.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-19.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-19 14:49:12.000000000
Message: 
Patch Set 7: -Code-Review

MAYBE FAIL sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-19.04.2022-16.10.fail.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-19 20:01:52.000000000
Message: 
Patch Set 7: Code-Review+1

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-19.04.2022-20.31.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-20 00:16:44.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-20.04.2022-01.44.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-20 08:01:38.000000000
Message: 
Patch Set 7: -Code-Review

MAYBE FAIL sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-20.04.2022-09.30.fail.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-20 13:12:16.000000000
Message: 
Patch Set 7: Code-Review+1

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-20.04.2022-13.43.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-20 17:27:01.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-20.04.2022-18.54.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-20 21:38:28.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-20.04.2022-23.09.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-21 02:55:29.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-21.04.2022-03.20.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-21 08:01:37.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-21.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-21 12:11:30.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-21.04.2022-13.43.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-21 17:27:25.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-21.04.2022-17.53.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-21 21:45:32.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-21.04.2022-23.09.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-22 02:10:14.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-22.04.2022-03.27.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-22 09:02:08.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-22.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-22 13:14:24.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-22.04.2022-14.43.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-22 17:24:26.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-22.04.2022-18.56.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-22 22:33:57.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-22.04.2022-23.06.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-23 02:49:46.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-23.04.2022-04.15.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-23 07:59:31.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-23.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-23 13:09:12.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-23.04.2022-13.41.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-23 17:21:46.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-23.04.2022-18.51.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-23 21:32:08.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-23.04.2022-23.03.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-24 02:42:51.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-24.04.2022-03.13.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-24 08:01:16.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-24.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-24 12:11:16.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-24.04.2022-13.43.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-24 17:21:21.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-24.04.2022-17.53.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-24 21:34:15.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-24.04.2022-23.03.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-25 01:44:29.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage fdb. See http://ci2i-unstable.northscale.in/gsi-25.04.2022-03.16.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-25 08:58:42.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage plasma. See http://ci2i-unstable.northscale.in/gsi-25.04.2022-09.30.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-25 13:12:43.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-25.04.2022-14.40.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: CI Bot
Date: 2022-04-26 08:25:09.000000000
Message: 
Patch Set 7:

PASS sanity,unit,functional,integration with storage memdb. See http://ci2i-unstable.northscale.in/gsi-26.04.2022-09.47.pass.html
----------------------------------------------------------------------------------------------------------------------
Author: VarunVelamuri
Date: 2022-04-26 08:26:02.000000000
Message: 
Removed reviewer <GERRIT_ACCOUNT_1004336> with the following votes:

* Code-Review+1 by <GERRIT_ACCOUNT_1004336>

----------------------------------------------------------------------------------------------------------------------
Author: VarunVelamuri
Date: 2022-04-26 08:49:16.000000000
Message: 
Patch Set 7:

(2 comments)
Line:1553, secondary/indexer/indexer.go -> Hi Kevin, Even with CGROUP, the logic will work here. Consider the following:

a. Default config has max_cpu_percent set to "0". And minNumShard set to runtime.GOMAXPROCS(0) - At this point, there is no change in CPU's. So, GOMAXPROCS(0) and runtime.NumCPU() will be similar. minNumShard will be 0.25*max_cpu_percent

b. If the CPU percent changes later while indexer initialises settings, then max_cpu_percent changes. The check at line 1561 compares if old values of minNumShard and max_cpu_percent are in sync or not. Since they will be in sync (i.e. minNumShard = 0.25 * max_cpu_percent), any change to max_cpu_percent will adjust minNumShard automatically

Line:1561, secondary/indexer/indexer.go -> Hi John, yes. This is done to honour any explicit change in minNumShard value. E.g,
on a 16 core box, the default minNumShard will be 4. If user changes this explicitly to 8 or 10 and if max_cpu_percent changes to 12, we do not want to change the minNumShard to 3. We will preserve the explicit setting change done by end user. Hence the logic is:

a. We check if the curr CPU Percent (Before the change) and minNumShard are in sync with each other (i.e. minNumShard = 0.25 * max_cpu_percent). If both are in sync, then we change minNumShard according to new max_cpu_percent.

b. If they are not in sync (which happens due to explicit change in minNumShard setting), then we ignore updating minNumShard value

This way, minNumShard value at indexer will always be equal to 0.25*max_cpu_percent irrespective of any setting change except for change in minNumShard itself

There is one corner case in this: when the explicit setting change and 25% of max_cpu_percent are equal, then further changes to max_cpu_percent will change minNumShard - As the settings changes are not frequent, I believe it should be fine

----------------------------------------------------------------------------------------------------------------------
Author: John Liang
Date: 2022-05-23 17:32:44.000000000
Message: 
Patch Set 7: Code-Review+1
----------------------------------------------------------------------------------------------------------------------
Author: Durga Akhil Mundroy
Date: 2022-05-24 04:12:35.000000000
Message: 
Patch Set 7: Code-Review+1
----------------------------------------------------------------------------------------------------------------------
