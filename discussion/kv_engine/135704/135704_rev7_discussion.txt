======================================================================================================================
DESCRIPTION:

executor_bench: Avoid GoogleMock overheads

MockTaskable has been enhanced to use GoogleMock for some
methods. This is very useful for functionality tests, however the cost
of calling a GoogleMock'd method can be significant in a performance
benchmark. For example, when using GoogleMock the performance of
ExecutorBench is constrained to ~150k items/s:

    ---------------------------------------------------------------------------------------------
    Benchmark                                                          Time       CPU Iterations
    ---------------------------------------------------------------------------------------------
    PureFollyExecutorBench/OneShotScheduleRun/real_time/threads:1   6099 ns   4669 ns     110575   160.116k items/s
    PureFollyExecutorBench/OneShotScheduleRun/real_time/threads:2   5459 ns   6957 ns     129910   178.877k items/s
    PureFollyExecutorBench/OneShotScheduleRun/real_time/threads:4   5961 ns   9899 ns     117004   163.833k items/s
    PureFollyExecutorBench/OneShotScheduleRun/real_time/threads:8   6453 ns  10697 ns     116592   151.336k items/s
    PureFollyExecutorBench/OneShotScheduleRun/real_time/threads:16  6524 ns  10936 ns     107904   149.695k items/s

By switching to a simple-as-possible, NullTaskable the performance of
this test can increase (up to) 3.8M items/s:

    ---------------------------------------------------------------------------------------------
    Benchmark                                                          Time       CPU Iterations
    ---------------------------------------------------------------------------------------------
    PureFollyExecutorBench/OneShotScheduleRun/real_time/threads:1    731 ns    671 ns     809899   1.30487M items/s
    PureFollyExecutorBench/OneShotScheduleRun/real_time/threads:2    410 ns    787 ns    1545102   2.32529M items/s
    PureFollyExecutorBench/OneShotScheduleRun/real_time/threads:4    249 ns    973 ns    2525496   3.82619M items/s
    PureFollyExecutorBench/OneShotScheduleRun/real_time/threads:8    407 ns   2595 ns    1694968   2.34305M items/s
    PureFollyExecutorBench/OneShotScheduleRun/real_time/threads:16  2222 ns   8268 ns     435984   439.488k items/s

Change-Id: I7ce255327908da4cdfb44449217340a66f5fb7d7
Reviewed-on: http://review.couchbase.org/c/kv_engine/+/135704
Tested-by: Build Bot <build@couchbase.com>
Reviewed-by: Trond Norbye <trond.norbye@couchbase.com>
Reviewed-by: Paolo Cocchi <paolo.cocchi@couchbase.com>

======================================================================================================================
COMMENTS
======================================================================================================================
Author: Trond Norbye
Date: 2020-09-16 06:37:04.000000000
Message: 
Change has been successfully cherry-picked as 4177aa71d70b4bb736c4e6876afa880d7fb6f8d6 by Trond Norbye
----------------------------------------------------------------------------------------------------------------------
Author: Build Bot
Date: 2020-09-16 06:37:16.000000000
Message: 
Patch Set 7:

Build Started http://cv.jenkins.couchbase.com/job/kv_engine-master-post-commit/4995/ (1/2)
----------------------------------------------------------------------------------------------------------------------
Author: Build Bot
Date: 2020-09-16 07:11:22.000000000
Message: 
Patch Set 7:

Build Successful 

http://cv.jenkins.couchbase.com/job/kv-engine-master-perf/3769/ : SUCCESS

http://cv.jenkins.couchbase.com/job/kv_engine-master-post-commit/4995/ : SUCCESS'
----------------------------------------------------------------------------------------------------------------------
